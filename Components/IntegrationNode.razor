@inherits Group

@if (!hidden)
{
    <div id=@Uid draggable="true" class="tb-item tb-draggable @CssClass @CssSelect"
         @ondblclick:preventDefault
         @ondblclick:stopPropagation
         @ondblclick="TriggerRenameModal"
         ondragover="event.preventDefault()"
         @ondragstart:stopPropagation
         @ondragstart="@(() => HandleOnDragStart(this))"
         @ondragend="HandleOnDragEnd"
         @ondrop:stopPropagation
         @ondrop="HandleOnDrop">
        
        @Title

        <br/>

        <div class="tb-flex">
            <div>    
                <IntegrationSlot Uid=@Items[0].Uid Iface=@(Items[0].Iface) Parent=@this Index=0 SaveToLocalStorageCallback=@this.SaveToLocalStorageCallback @key=Items[0]></IntegrationSlot>
            </div>
            <div class="flex-column">
               
                @if (Items[1].Iface != null || showExtraSlots) {
                    <IntegrationSlot Uid=@Items[1].Uid Iface=@(Items[1].Iface) Parent=@this Index=1 SaveToLocalStorageCallback=@this.SaveToLocalStorageCallback @key=Items[1]></IntegrationSlot>
                }

                <IntegrationSlot Uid=@Items[2].Uid Iface=@(Items[2].Iface) Parent=@this Index=2 SaveToLocalStorageCallback=@this.SaveToLocalStorageCallback @key=Items[2]></IntegrationSlot>

                @if (Items[3].Iface != null || showExtraSlots) {
                    <IntegrationSlot Uid=@Items[3].Uid Iface=@(Items[3].Iface) Parent=@this Index=3 SaveToLocalStorageCallback=@this.SaveToLocalStorageCallback @key=Items[3]></IntegrationSlot>
                }
                

            </div>
            
        </div>
        <div class="flex-column">
            @foreach (var node in Nodes) {
                <IntegrationNode Uid=@node.Uid Items=@node.Items Nodes=@node.Nodes Parent=@this SaveToLocalStorageCallback=@this.SaveToLocalStorageCallback></IntegrationNode>
            }
        </div>
    </div>
}

<TelerikWindow Modal="true" @bind-Visible="@renameModal">
    <WindowTitle>
        <strong>Rename</strong>
    </WindowTitle>
    <WindowContent>
        <TelerikTextBox @bind-Value="Title" Label="Enter new title"></TelerikTextBox><br/>
        <TelerikButton OnClick="TriggerRenameModal">Save</TelerikButton>
    </WindowContent>
</TelerikWindow>